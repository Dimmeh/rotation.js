/*! rotation.js - v0.4.1 - 2014-01-03 */!function(a,b,c){"use strict";var d="rotation",e={namespace:"rotation",autoRotate:!0,interval:4e3,duration:300,transitionIn:"fadeIn",transitionOut:"fadeOut",orientation:"horizontal",pauseOnHover:!0,stopOnHover:!1,scrolling:!0,keypress:!0,touch:!0,touchDelay:500,touchMin:30,touchMax:320,loop:!0,visibleItems:1,step:1,itemWidth:200,responsive:!0,responsiveDelay:150,containerClass:"rotation-container",pausePlayControl:!0,pausePlayControlClass:"rotation-play-pause",pauseText:"Pause",playText:"Play",navControls:!0,navControlsClass:"rotation-nav-controls",navControlsItemClass:"rotation-item",navControlsNextClass:"rotation-next",navControlsPrevClass:"rotation-prev",navControlsNextText:">>",navControlsPrevText:"<<",pagination:!0,paginationNumbers:!0,paginationClass:"rotation-pagination",paginationItemClass:"rotation-page",paginationCurrentItemClass:"current",beforeInit:a.noop,afterInit:a.noop,beforeTransition:a.noop,afterTransition:a.noop,onSwipeLeft:a.noop,onSwipeRight:a.noop,onSwipeUp:a.noop,onSwipeDown:a.noop,onSwipe:a.noop},f=function(b,f){var g,h,i=this;return this.options=a.extend({},e,f),g=a("<section/>",{"class":this.getOption("containerClass")}),h=a("<div/>",{"class":"rotation-viewport"}),this._defaults=e,this._name=d,this.currentIndex=0,this.isAnimating=!1,this.touchSupported="ontouchend"in c,this.itemsContainer=b,this.$itemsContainer=a(this.itemsContainer),this.$itemsViewport=this.$itemsContainer.wrap(h).parent(),this.$items=this.$itemsContainer.children(),this.$container=this.$itemsViewport.wrap(g).parent(),this.metadata=this.$container.data("rotation-options"),this.$items.detach(),this.$itemsContainer.empty(),this.$itemsContainer.append(this.$items),this.options.beforeInit.call(this),this.validate(),this.init(),this.build(),this.bindEvents(),this.play(),this.options.afterInit.call(this),{add:function(){},play:function(){i.play()},pause:function(){i.pause()},itemsCount:function(){return i.itemsCount()},current:function(){return i.currentIndex},setCurrent:function(a,b){i.currentIndex=a,b&&b.call()},next:function(){i.rotate(+i.getOption("step"))},previous:function(){i.rotate(-i.getOption("step"))},destroy:function(){}}};f.VERSION="0.4.1",a.extend(f.prototype,{getOption:function(a){return this.options[a]},setOption:function(a,b){return this.options[a]=b,b},triggerCustomEvent:function(a,b){a.trigger(b)},itemsCount:function(){return this.$items.length},getItemByIndex:function(a){return this.$items.eq(a)},lockAnimation:function(){this.isAnimating=!0},isLocked:function(){return!!this.isAnimating},unlockAnimation:function(){this.isAnimating=!1},init:function(){var c=this;this.$window=a(b),this.windowHeight=this.$window.height(),this.windowWidth=this.$window.width(),this.viewportWidth=this.$itemsViewport.outerWidth(!0),this.itemWidth=this.viewportWidth/this.getOption("visibleItems"),this.itemsWidth=this.itemWidth*this.itemsCount(),this.initIdsOnElements(),this.$itemsContainer.width(this.itemsWidth),this.$items.width(this.itemWidth),this.$items.hide();var d=this.$items.slice(0,this.getOption("visibleItems"));a.each(d,function(b,d){a(d).css("left",b*c.itemWidth).show()})},initIdsOnElements:function(){var a;for(a=0;a<this.itemsCount();a++)this.getItemByIndex(a).addClass("rotation-item-"+(a+1))},validate:function(){var a=this.getOption("respnosive"),b=this.getOption("orientation");"boolean"!=typeof a&&this.setOption("responsive",Boolean(a)),"horizontal"!==b&&"vertical"!==b&&this.setOption("orientation","horizontal")},bindEvents:function(){this.getOption("responsive")&&this.bindResizeEvent(),this.getOption("pauseOnHover")&&this.bindMouseEvents(),this.getOption("scrolling")&&this.bindScrolling(),this.getOption("keypress")&&this.bindKeyboardEvents(),this.getOption("touch")&&this.bindTouchEvents()},bindResizeEvent:function(){var a,b=this;b.$window.on("resize",function(c){if(c.originalEvent){var d=b.$window.width(),e=b.$window.height();(d!==b.windowWidth||e!==b.windowHeight)&&(b.windowWidth=d,b.windowHeight=e,clearTimeout(a),a=setTimeout(function(){b.init(),b.rotate(0)},b.getOption("responsiveDelay")))}})},bindKeyboardEvents:function(){var b=this;a(c).on("keydown",function(a){39===a.keyCode&&b.rotate(+b.getOption("step")),37===a.keyCode&&b.rotate(-b.getOption("step"))})},bindMouseEvents:function(){var a=this;this.$itemsContainer.on("mouseenter",function(){a.setOption("autoRotate",!1)}).on("mouseleave",function(){a.setOption("autoRotate",!0)})},bindScrolling:function(){var a=this;this.$itemsContainer.on("mousewheel",function(b){b.preventDefault(),a.rotate(a.currentIndex+a.getOption("step"))})},bindTouchEvents:function(){var b,c,d,e,f,g,h=this,i=h.getOption("touchDelay"),j=h.getOption("touchMin"),k=h.getOption("touchMax"),l=h.touchSupported?"touchstart":"mousedown",m=h.touchSupported?"touchend":"mouseout",n=h.touchSupported?"touchmove":"mousemove",o=function(a){return a.pageX?a:a.originalEvent.touches[0]||a.originalEvent.changedTouches[0]},p=function(b){var c=o(b);return{time:(new Date).getTime(),touch:c,coords:[c.pageX,c.pageY],origin:a(b.target)}},q=function(a){a.preventDefault(),c=p(a)},r=function(a){c&&(d=p(a),Math.abs(c.coords[0]-d.coords[0])>10&&a.preventDefault())},s=function(l){if(l.preventDefault(),c&&d){if(b=d.time-c.time,f=Math.abs(c.coords[0]-d.coords[0]),g=Math.abs(c.coords[1]-d.coords[1]),e=Math.sqrt(f*f+g*g),15>e&&100>b)return c.origin.trigger("click"),void 0;if(i>b&&e>=j&&k>=e){var m=["swipe"];f>=j&&j>g?c.coords[0]>d.coords[0]?(m.push("swipeleft"),h.setOption("autoRotate",!0),h.rotate(-h.getOption("step"))):(m.push("swiperight"),h.setOption("autoRotate",!0),h.rotate(+h.getOption("step"))):g>=j&&j>f&&(c.coords[1]<d.coords[1]?m.push("swipedown"):m.push("swipeup")),a.each(m,function(b,e){var f=a.Event(e,{target:l.target,swipestart:c,swipeend:d});h.triggerCustomEvent(h.$itemsContainer,f)})}}};h.$itemsContainer.on(l,q).on(n,r).on(m,s)},rotate:function(a,b){if(!(this.itemsCount()<=1)&&this.getOption("autoRotate")){a&&this.pause(),this.getOption("beforeTransition").call(this,this.currentIndex);var c,d,e=this.currentIndex,f=this.itemsCount(),g=this.getItemByIndex(e);e=0===e&&0>a?f-1:(a?e+a:++e)%f,c=this.getItemByIndex(e),d=a?a*this.itemWidth:this.itemWidth,this.$itemsContainer.stop(),this.isLocked()||(this.lockAnimation(),"horizontal"===this.getOption("orientation")&&this.animations.slideHorizontal.call(this,g,c,d,e),this.getOption("pagination")&&this.setPaginationCurrentItem(a),this.getOption("afterTransition").call(this,this.currentIndex),b&&"function"==typeof b&&b(),a&&this.play())}},animations:{slideHorizontal:function(b,c,d,e){var f=this,g=this.getOption("duration");a.when(a(b).css({left:0}).animate({left:-d},{duration:g}),a(c).css({left:d}).show().animate({left:0},{duration:g})).done(function(){f.currentIndex=e,f.unlockAnimation()})}},play:function(){var b=this;this.getOption("autoRotate")&&(this.auto=setInterval(function(){b.rotate()},this.getOption("interval")),b.triggerCustomEvent(b.$itemsContainer,a.Event("play")))},pause:function(){var b=this;b.auto&&(b.auto=clearInterval(b.auto),b.triggerCustomEvent(b.$itemsContainer,a.Event("pause")))},setPaginationCurrentItem:function(b){var c,d,e,f,g=this.getOption("paginationCurrentItemClass"),h=a("."+this.getOption("paginationClass"),this.container),i=a("a."+g,h).parent("li");f=0>b?"last":"first",c=b?0>b?this.currentIndex+b:this.currentIndex+b-1:this.currentIndex,d=i.siblings().eq(c),e=d.length?d.find("a"):a("a:"+f,h),a("a."+g,h).removeClass(g),e.addClass(g)},build:function(){this.getOption("navControls")&&this.buildNavControls(),this.getOption("pagination")&&this.buildPagination()},buildNavControls:function(){if(!(this.itemsCount()<=1)){var b,c,d=this,e=this.$container;b=a("<ul/>",{"class":this.getOption("navControlsClass")}),a("<nav/>").wrapInner(b).appendTo(e),c=a("<a/>",{href:"#","class":this.getOption("navControlsItemClass")+" "+this.getOption("navControlsPrevClass"),"data-direction":-this.getOption("step"),html:this.getOption("navControlsPrevText")}),a("<li/>").wrapInner(c).appendTo(b),c=a("<a/>",{href:"#","class":this.getOption("navControlsItemClass")+" "+this.getOption("navControlsNextClass"),"data-direction":+this.getOption("step"),html:this.getOption("navControlsNextText")}),a("<li/>").wrapInner(c).appendTo(b),b.children().find("a").on("click",function(b){b.preventDefault();var c=+a(this).data("direction");d.rotate(c)})}},buildPagination:function(){if(!(this.itemsCount()<=1)){var b,c,d,e,f,g=this,h=this.$container;for(b=a("<ol/>",{"class":this.getOption("paginationClass"),role:"navigation","aria-labelledby":"paginglabel"}),b.appendTo(h),e=0;e<this.itemsCount();e++)c=a("<li/>"),d=a("<a/>",{href:"#rotation-item-"+e,"data-index":e,text:this.getOption("paginationNumbers")?e+1:"","class":this.getOption("paginationItemClass")}),d.appendTo(c),c.appendTo(b);f=a("li",b).children(),f.eq(0).addClass(this.getOption("paginationCurrentItemClass")),f.on("click touchstart",function(b){b.preventDefault();var c,d,e=a(this),f=g.getOption("paginationCurrentItemClass"),h=+e.data("index");d=+e.parent("li").siblings("li").find("a."+f).data("index"),c=h-d,g.rotate(c)})}}}),f.defaults=f.prototype.defaults,a.fn[d]=function(b){return this.each(function(){var c=this,e=a.data(c,d);e||a.data(c,d,new f(c,b))})},b.Rotation=f}(jQuery,window,document);